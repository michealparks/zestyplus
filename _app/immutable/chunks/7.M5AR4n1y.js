import{b as k,t as V}from"./disclose-version.DFxnx1AN.js";import{B as G,Q as C,D as O,a8 as I,n as H,a9 as f,u as J}from"./runtime.BxeNZxLl.js";import{c as U}from"./svelte-component.C7V4StSs.js";import{aw as W,C as R,B as A,h as E,p as K,V as Q,o as N,ax as $,I as ee,ay as te,J as oe,Q as re}from"./three.module.iKKkBh6O.js";import{u as Y,T as m,a as ae}from"./T.BojAtv_L.js";import{a as ne}from"./auth.svelte.CMqokhwd.js";import{h as q}from"./color.D7bleQK4.js";import{f as se}from"./index.B_O87gS3.js";import{R as ie}from"./RoundedBoxGeometry.CMIwH6ie.js";import"./legacy.u_OnCUt7.js";import{s as ce}from"./snippet.AXKrw6tU.js";import{p as c,s as le,r as de}from"./props.CvCzEa8T.js";import{L as ue}from"./Lightformer.C-GXGN2k.js";const fe=`uniform float time;
attribute float size;
varying vec3 vColor;
void main() {
	vColor = color;
	vec4 mvPosition = modelViewMatrix * vec4(position, 0.5);
	gl_PointSize = size * (30.0 / -mvPosition.z) * (3.0 + sin(time + 100.0));
	gl_Position = projectionMatrix * mvPosition;
}`;var me=V("<!> <!> <!>",1);function pe(L,r){G(r,!0);let a=c(r,"count",3,5e3),j=c(r,"radius",3,50),p=c(r,"depth",3,50),t=c(r,"factor",3,6),l=c(r,"saturation",3,1),g=c(r,"lightness",3,.8),h=c(r,"speed",3,1),d=c(r,"fade",3,!0),D=c(r,"opacity",3,1),S=c(r,"ref",15),P=de(r,["$$slots","$$events","$$legacy","count","radius","depth","factor","saturation","lightness","speed","fade","opacity","ref","children"]);const b=new W,w=new Q,_=new N,v=new R,F=s=>w.setFromSpherical(_.set(s,Math.acos(1-Math.random()*2),Math.random()*2*Math.PI));let y=new A(new Float32Array(a()*3),3),M=new A(new Float32Array(a()*3),3),x=new A(new Float32Array(a()),1);C(()=>{y=new A(new Float32Array(a()*3),3),M=new A(new Float32Array(a()*3),3),x=new A(new Float32Array(a()),1)}),C(()=>{const s=p()/a();let z=j()+p();for(let i=0;i<a();i+=1){z-=s*Math.random();const u=F(z);y.setXYZ(i,u.x,u.y,u.z),v.setHSL(i/a(),l(),g()),M.setXYZ(i,v.r,v.g,v.b),x.setX(i,(.5+.5*Math.random())*t())}});const{stop:B,start:T}=Y(s=>{e.time.value+=s*h()},{autoStart:!1});C(()=>h()===0?B():T());const e={time:{value:0},fade:{value:1},opacity:{value:1}},o=new E({uniforms:e,vertexShader:fe,fragmentShader:se});C(()=>{e.fade.value=d()?1:0}),C(()=>{e.opacity.value=D()});const n=new K;n.setAttribute("position",y),n.setAttribute("color",M),n.setAttribute("size",x),m(L,le({is:b},()=>P,{get ref(){return S()},set ref(s){S(s)},children:(s,z)=>{var i=me(),u=I(i);m(u,{is:n});var X=f(u,2);m(X,{is:o,blending:$,depthWrite:!1,transparent:!0,vertexColors:!0});var Z=f(X,2);ce(Z,()=>r.children??H,()=>({ref:b})),k(s,i)},$$slots:{default:!0}})),O()}var he=V("<!> <!>",1),ve=V("<!> <!> <!> <!> <!> <!>",1);function ge(L,r){G(r,!0);const{camera:a,scene:j}=ae(),p=1e3,t=new ee(void 0,void 0,p);t.name="cubes",t.frustumCulled=!1,t.castShadow=t.receiveShadow=!0;const l=new Q,g=new re,h=new Q(1,1,1),d=new oe,{frequencyData:D}=ne();let S=p-1;const P="#C84C09",b=new R(P);J(()=>{for(let e=0;e<p;e+=1){const o=(Math.random()-.5)*5,n=o>0?2:-2,s=(Math.random()-.5)*10;l.set(o*2+n,s,-e/2),g.random(),d.compose(l,g,h),t.setMatrixAt(e,d),t.setColorAt(e,q(b,0))}t.instanceColor&&(t.instanceColor.needsUpdate=!0),t.instanceMatrix.needsUpdate=!0});const w=new te;j.add(w.target);let _;Y(e=>{a.current.position.z-=e*20,_&&(_.position.z=a.current.position.z,w.position.z=a.current.position.z+2,w.target.position.copy(a.current.position));for(let o=0;o<p;o+=1){t.getMatrixAt(o,d),d.decompose(l,g,h);const n=D.current[o%32];h.setScalar(Math.max(n/100,.5)),t.setColorAt(o,q(b.set(P),n/1e3)),l.z>a.current.position.z&&(l.z=-S/2,S+=1),d.compose(l,g,h),t.setMatrixAt(o,d)}t.instanceColor&&(t.instanceColor.needsUpdate=!0),t.instanceMatrix.needsUpdate=!0});var v=ve(),F=I(v);U(F,()=>m.PerspectiveCamera,(e,o)=>{o(e,{makeDefault:!0,position:[0,.5,5],oncreate:n=>n.lookAt(0,0,.1)})});var y=f(F,2);m(y,{is:w,castShadow:!0,"position.x":2,"position.y":2,intensity:.5});var M=f(y,2);U(M,()=>m.AmbientLight,(e,o)=>{o(e,{intensity:.5})});var x=f(M,2);m(x,{is:t,children:(e,o)=>{var n=he(),s=I(n);ie(s,{});var z=f(s,2);U(z,()=>m.MeshStandardMaterial,(i,u)=>{u(i,{roughness:.05})}),k(e,n)},$$slots:{default:!0}});var B=f(x,2);ue(B,{});var T=f(B,2);pe(T,{get ref(){return _},set ref(e){_=e}}),k(L,v),O()}const Le=Object.freeze(Object.defineProperty({__proto__:null,default:ge},Symbol.toStringTag,{value:"Module"}));export{ge as _,Le as a};
