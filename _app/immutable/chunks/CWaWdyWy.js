import"./DsnmJJEf.js";import{a3 as Lt,a8 as xt,ar as T,a6 as m,aa as Ct,a7 as u,f as t,a4 as c,b as J,ag as Pt,a5 as mt,a9 as g}from"./DGLrSMKY.js";import{i as k}from"./Br_VAdLV.js";import{e as at,i as Rt}from"./D0C52aKJ.js";import{c as F}from"./CGE0CeKR.js";import{p as G,a as zt,r as Ht,b as Bt,s as ot}from"./D7NB5tT8.js";import{ao as Q,A as jt,fZ as K,f_ as o,f$ as Ot,e1 as Ut}from"./C_yIfSnU.js";import{u as nt}from"./Bnc-NxSZ.js";import"./B06ctdTw.js";import{s as Et}from"./BXYCPDa6.js";import{e as Nt}from"./CxTOoE5I.js";import{R as Wt}from"./DwCNAWRA.js";import{u as Zt}from"./wM1BCSX6.js";function Tt(st,d){Lt(d,!0);let b=G(d,"speed",3,1),A=G(d,"floatIntensity",3,1),B=G(d,"floatingRange",19,()=>[-.1,.1]),w=G(d,"rotationSpeed",3,0),$=G(d,"rotationIntensity",3,0),it=G(d,"seed",19,()=>1e4*Math.random()),V=G(d,"ref",15),I=Ht(d,["$$slots","$$events","$$legacy","speed","floatIntensity","floatingRange","rotationSpeed","rotationIntensity","seed","ref","children"]);const D=new Q,f=new Q;let v=it();const j=jt.mapLinear;let O=c(()=>Array.isArray(b())?b():[b(),b(),b()]),U=c(()=>Array.isArray(A())?A():[A(),A(),A()]),E=c(()=>B().length===3?B():[[0,0],B(),[0,0]]),M=c(()=>Array.isArray(w())?w():[w(),w(),w()]),C=c(()=>Array.isArray($())?$():[$(),$(),$()]);K(L=>{v+=L,f.position.x=j(Math.sin(v/4*t(O)[0])/10,-.1,.1,...t(E)[0])*t(U)[0],f.position.y=j(Math.sin(v/4*t(O)[1])/10,-.1,.1,...t(E)[1])*t(U)[1],f.position.z=j(Math.sin(v/4*t(O)[2])/10,-.1,.1,...t(E)[2])*t(U)[2],f.rotation.x=Math.cos(v/4*t(M)[0])/8*t(C)[0],f.rotation.y=Math.sin(v/4*t(M)[1])/8*t(C)[1],f.rotation.z=Math.sin(v/4*t(M)[2])/20*t(C)[2],f.updateMatrix()}),o(st,zt({get is(){return D}},()=>I,{get ref(){return V()},set ref(L){V(L)},children:(L,lt)=>{o(L,{get is(){return f},matrixAutoUpdate:!1,children:(ct,X)=>{var p=T(),P=m(p);Et(P,()=>d.children??Ct,()=>({ref:f})),u(ct,p)},$$slots:{default:!0}})},$$slots:{default:!0}})),xt()}var qt=mt("<!> <!> <!> <!> <!> <!> <!> <!> <!>",1),Jt=mt("<!> <!>",1),Kt=mt("<!> <!> <!> <!>",1);function Qt(st,d){Lt(d,!0);const b=()=>ot(j,"$trainHeadGLTF",$),A=()=>ot(O,"$trainCarGLTF",$),B=()=>ot(U,"$trackGLTF",$),w=()=>ot(E,"$tree1GLTF",$),[$,it]=Bt();Nt.setLTC(Wt.init());const V=Zt(),{scene:I}=Ot();J(()=>(I.fog=new Ut("black"),I.fog.near=80,I.fog.far=200,()=>I.fog=null));const D=new Q,f=new Q,v=new Q,j=nt("/glb/HighSpeed_Front.glb"),O=nt("/glb/HighSpeed_Wagon.glb"),U=nt("/glb/RailwayTrack_Straight.glb"),E=nt("/glb/Tree_1.glb"),M=c(()=>b()?.scene),C=c(()=>A()?.scene),L=c(()=>B()?.scene),lt=c(()=>w()?.scene),ct=15,X=7,p=c(()=>t(L)?Array.from({length:ct}).map(()=>t(L).clone()):void 0),P=c(()=>t(C)?Array.from({length:X}).map(()=>t(C).clone()):void 0),x=c(()=>t(lt)?Array.from({length:40}).map(()=>t(lt).clone()):void 0);let N=0,dt=-18,W=0,Y=-32;const tt=e=>{e.castShadow=!0,e.receiveShadow=!0},Ft=1/3,ut=(e,r)=>{if(e.position.x=r,Math.random()<Ft){const y=5+Math.random()*15;e.position.z=y}else{const y=20+Math.random()*70;e.position.z=-y}e.scale.setScalar(Math.random()*.25+.75),e.rotation.y=Math.random()*2*Math.PI};J(()=>{t(M)?.traverse(tt)}),J(()=>{if(t(P)){let e=11.5;for(const r of t(P))r.position.x=e,e+=11.5,r.traverse(tt)}}),J(()=>{if(t(p)){let e=-18;for(const r of t(p))r.position.x=e,e+=18,r.traverse(tt);N=t(p).length}}),J(()=>{if(t(x)){let e=-32;for(const r of t(x))ut(r,e),e+=18,r.traverse(tt);W=t(x).length,Y=-32}});const pt=10,bt=50;K(e=>{D.position.x-=e*bt}),K(()=>{if(!t(p))return;const{x:e}=D.position;e<dt+pt&&(N-=1,dt-=18,t(p)[N].position.x=dt,N===0&&(N=t(p).length))}),K(()=>{if(!t(x))return;const{x:e}=D.position;if(e<Y+pt){W-=1,Y-=18;const r=t(x)[W];ut(r,Y),W===0&&(W=t(x).length)}});const ft=Pt(Array.from({length:X+1}).fill(0));K(()=>{for(let e=0,r=0,h=ft.length;e<h;e+=1,r+=2)ft[e]=V.spectrum01[r]});var ht=Kt(),_t=m(ht);o(_t,{get is(){return D},children:(e,r)=>{var h=qt(),l=m(h);at(l,17,()=>({length:X+1}),Rt,(a,n,s)=>{var i=T(),S=m(i);{const H=(q,gt)=>{var rt=T(),Dt=m(rt);k(Dt,Vt=>{}),u(q,rt)};let et=c(()=>150*ft[s]);F(S,()=>o.RectAreaLight,(q,gt)=>{gt(q,{width:6.8,height:.3,color:"#FFD700",get intensity(){return t(et)},position:[.75+s*11.3,1,1.02],oncreate:rt=>{rt.lookAt(.75+s*11.3,1,-2)},children:H,$$slots:{default:!0}})})}u(a,i)});var _=g(l,2);F(_,()=>o.AmbientLight,(a,n)=>{n(a,{intensity:.2})});var y=g(_,2);o(y,{get is(){return v},position:[0,1,0]});var Z=g(y,2);{const a=(n,s)=>{var i=T(),S=m(i);k(S,H=>{}),u(n,i)};F(Z,()=>o.DirectionalLight,(n,s)=>{s(n,{intensity:1,castShadow:!0,color:"#FFF8DE",position:[-5,8,5],"shadow.camera.left":-50,"shadow.camera.right":50,"shadow.camera.top":50,"shadow.camera.bottom":-50,"shadow.mapSize.width":8192,"shadow.mapSize.height":8192,get target(){return v},children:a,$$slots:{default:!0}})})}var R=g(Z,2);o(R,{get is(){return f},position:[-20,1,0]});var z=g(R,2);{const a=(n,s)=>{var i=T(),S=m(i);k(S,H=>{}),u(n,i)};F(z,()=>o.SpotLight,(n,s)=>{s(n,{castShadow:!0,color:"#FFD700",penumbra:.9,position:[-5,1,0],intensity:20,angle:Math.PI/4,get target(){return f},children:a,$$slots:{default:!0}})})}var yt=g(z,2);Tt(yt,{floatIntensity:3,speed:2,rotationIntensity:.3,rotationSpeed:2,children:(a,n)=>{var s=T(),i=m(s);F(i,()=>o.PerspectiveCamera,(S,H)=>{H(S,{makeDefault:!0,position:[-15,5,15],oncreate:et=>{et.lookAt(0,0,0)}})}),u(a,s)},$$slots:{default:!0}});var St=g(yt,2);{var kt=a=>{o(a,{get is(){return t(M)}})};k(St,a=>{t(M)&&a(kt)})}var Gt=g(St,2);{var It=a=>{var n=T(),s=m(n);at(s,17,()=>t(P),i=>i.uuid,(i,S,H,et)=>{Tt(i,{floatIntensity:.01,speed:50,rotationIntensity:.001,rotationSpeed:20,children:(q,gt)=>{o(q,{get is(){return t(S)}})},$$slots:{default:!0}})}),u(a,n)};k(Gt,a=>{t(P)&&a(It)})}u(e,h)},$$slots:{default:!0}});var $t=g(_t,2);{var At=e=>{var r=T(),h=m(r);at(h,17,()=>t(p),l=>l.uuid,(l,_,y,Z)=>{o(l,{get is(){return t(_)}})}),u(e,r)};k($t,e=>{t(p)&&e(At)})}var vt=g($t,2);{var wt=e=>{var r=T(),h=m(r);at(h,17,()=>t(x),l=>l.id,(l,_)=>{o(l,{get is(){return t(_)}})}),u(e,r)};k(vt,e=>{t(x)&&e(wt)})}var Mt=g(vt,2);F(Mt,()=>o.Mesh,(e,r)=>{r(e,{position:[0,-.2,0],children:(h,l)=>{var _=Jt(),y=m(_);F(y,()=>o.BoxGeometry,(R,z)=>{z(R,{args:[1e4,.1,200]})});var Z=g(y,2);F(Z,()=>o.MeshToonMaterial,(R,z)=>{z(R,{color:"#222"})}),u(h,_)},$$slots:{default:!0}})}),u(st,ht),xt(),it()}const fe=Object.freeze(Object.defineProperty({__proto__:null,default:Qt},Symbol.toStringTag,{value:"Module"}));export{Qt as _,fe as a};
