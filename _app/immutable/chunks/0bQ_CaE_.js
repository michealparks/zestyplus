import"./DsnmJJEf.js";import{a3 as ke,d as $,a7 as Oe,a8 as Qe,aa as T,a9 as Ye,a5 as qe}from"./Wk8iZnnz.js";import{c as O}from"./BXm_g8N-.js";import{s as Re,b as Ee}from"./oafpEiTJ.js";import{u as Ve}from"./CXVFCYzG.js";import{h as Ue}from"./D7bleQK4.js";import{F as We,fy as Ie,n as ee,k as be,fZ as Ke,y as te,aj as Xe,aW as se,eq as Fe,ed as Ze,eM as Je,M as W,a as $e,f_ as Be,f$ as R,dP as et,c5 as tt,t as Ne,bn as Te,b7 as st,ak as ot,B as at,c as nt}from"./CtU81MLD.js";import{b as rt,N as it,R as ye,Q as lt,c as ct,f as ut,V as dt,d as At,M as ft}from"./aEY0d7t_.js";import{F as re,N as ht,O as pt,E as mt,n as vt,k as gt,u as Y,A as wt,g as Ht,e as xe,l as Pt,f as Se,w as Rt,q as bt,P as Bt,v as Nt,t as Me,Q as Tt,H as _e,R as yt}from"./BE5HZdlT.js";import{R as xt}from"./p4dozJBP.js";const{lerp:z}=We,d=[151,160,137,91,90,15,131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,190,6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,88,237,149,56,87,174,20,125,136,171,168,68,175,74,165,71,134,139,48,27,166,77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,102,143,54,65,25,63,161,1,216,80,73,209,76,132,187,208,89,18,169,200,196,135,130,116,188,159,86,164,100,109,198,173,186,3,64,52,217,226,250,124,123,5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,223,183,170,213,119,248,152,2,44,154,163,70,221,153,101,155,167,43,172,9,129,22,39,253,19,98,108,110,79,113,224,232,178,185,112,104,218,246,97,228,251,34,242,193,238,210,144,12,191,179,162,241,81,51,145,235,249,14,239,107,49,192,214,31,181,199,106,157,184,84,204,176,115,121,50,45,127,4,150,254,138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180];for(let i=0;i<256;i++)d[256+i]=d[i];function oe(i){return i*i*i*(i*(i*6-15)+10)}function G(i,a,o,n){const r=i&15,A=r<8?a:o,f=r<4?o:r==12||r==14?a:n;return((r&1)==0?A:-A)+((r&2)==0?f:-f)}class St{noise(a,o,n){const r=Math.floor(a),A=Math.floor(o),f=Math.floor(n),C=r&255,y=A&255,b=f&255;a-=r,o-=A,n-=f;const c=a-1,B=o-1,m=n-1,x=oe(a),S=oe(o),M=oe(n),L=d[C]+y,w=d[L]+b,v=d[L+1]+b,H=d[C+1]+y,P=d[H]+b,_=d[H+1]+b;return z(z(z(G(d[w],a,o,n),G(d[P],c,o,n),x),z(G(d[v],a,B,n),G(d[_],c,B,n),x),S),z(z(G(d[w+1],a,o,m),G(d[P+1],c,o,m),x),z(G(d[v+1],a,B,m),G(d[_+1],c,B,m),x),S),M)}}let ae=null;const Mt=re(([i])=>(ae===null&&(ae=new Ie().load("data:image/png;base64,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")),ht(ae,pt(i).mod(mt(16))))),Q=new lt;let ne;class _t extends rt{static get type(){return"GaussianBlurNode"}constructor(a,o=null,n=4,r={}){super("vec4"),this.textureNode=a,this.directionNode=o,this.sigma=n,this._invSize=Y(new ee),this._passDirection=Y(new ee),this._horizontalRT=new be(1,1,{depthBuffer:!1}),this._horizontalRT.texture.name="GaussianBlurNode.horizontal",this._verticalRT=new be(1,1,{depthBuffer:!1}),this._verticalRT.texture.name="GaussianBlurNode.vertical",this._textureNode=wt(this,this._verticalRT.texture),this._textureNode.uvNode=a.uvNode,this.updateBeforeType=it.FRAME,this.resolutionScale=r.resolutionScale||1,this.premultipliedAlpha=r.premultipliedAlpha||!1}setSize(a,o){a=Math.max(Math.round(a*this.resolutionScale),1),o=Math.max(Math.round(o*this.resolutionScale),1),this._invSize.value.set(1/a,1/o),this._horizontalRT.setSize(a,o),this._verticalRT.setSize(a,o)}updateBefore(a){const{renderer:o}=a;ne=ye.resetRendererState(o,ne);const n=this.textureNode,r=n.value,A=n.value;Q.material=this._material,this.setSize(r.image.width,r.image.height);const f=r.type;this._horizontalRT.texture.type=f,this._verticalRT.texture.type=f,o.setRenderTarget(this._horizontalRT),this._passDirection.value.set(1,0),Q.name="Gaussian Blur [ Horizontal Pass ]",Q.render(o),n.value=this._horizontalRT.texture,o.setRenderTarget(this._verticalRT),this._passDirection.value.set(0,1),Q.name="Gaussian Blur [ Vertical Pass ]",Q.render(o),n.value=A,ye.restoreRendererState(o,ne)}getTextureNode(){return this._textureNode}setup(a){const o=this.textureNode,n=Ht(),r=xe(this.directionNode||1);let A,f;this.premultipliedAlpha?(A=c=>Rt(o.sample(c)),f=c=>bt(c)):(A=c=>o.sample(c),f=c=>c);const C=re(()=>{const c=3+2*this.sigma,B=this._getCoefficients(c),m=this._invSize,x=r.mul(this._passDirection),S=Pt(A(n).mul(B[0])).toVar();for(let M=1;M<c;M++){const L=Se(M),w=Se(B[M]),v=xe(x.mul(m.mul(L))).toVar(),H=A(n.add(v)),P=A(n.sub(v));S.addAssign(H.add(P).mul(w))}return f(S)}),y=this._material||(this._material=new ct);y.fragmentNode=C().context(a.getSharedContext()),y.name="Gaussian_blur",y.needsUpdate=!0;const b=a.getNodeProperties(this);return b.textureNode=o,this._textureNode}dispose(){this._horizontalRT.dispose(),this._verticalRT.dispose()}_getCoefficients(a){const o=[],n=a/3;for(let r=0;r<a;r++)o.push(.39894*Math.exp(-.5*r*r/(n*n))/n);return o}get resolution(){return console.warn('THREE.GaussianBlurNode: The "resolution" property has been renamed to "resolutionScale" and is now of type `number`.'),new ee(this.resolutionScale,this.resolutionScale)}set resolution(a){console.warn('THREE.GaussianBlurNode: The "resolution" property has been renamed to "resolutionScale" and is now of type `number`.'),this.resolutionScale=a.x}}const Dt=(i,a,o,n={})=>vt(new _t(gt(i),a,o,n));var Gt=Oe("<!> <!> <!> <!> <!> <!> <!> <!> <!> <!>",1);function Ct(i,a){ke(a,!0);const o=()=>Re(B,"$size",r),n=()=>Re(f,"$camera",r),[r,A]=Ee(),{camera:f,scene:C,renderer:y,renderMode:b,renderStage:c,size:B}=Ke();$(()=>(b.set("manual"),()=>b.set("always")));const m=10;function x(){let s=0;const e=128,t=new Uint8Array(e*e*e),h=10,l=new St,u=5;for(let N=0;N<e;N++)for(let g=0;g<e;g++)for(let j=0;j<e;j++){const k=j/e*u,He=g/e*u,V=N/e*u,U=l.noise(k*h,He*h,V*h);t[s]=128+128*U,s+=1}const p=new et(t,e,e,e);return p.format=tt,p.minFilter=Ne,p.magFilter=Ne,p.wrapS=Te,p.wrapT=Te,p.unpackAlignment=1,p.needsUpdate=!0,p}const S=Ve();ut.setLTC(xt.init());const M=x(),L=Y(3.5),w=new dt;w.steps=12,w.offsetNode=Mt(Bt),w.scatteringNode=re(({positionRay:s})=>{const e=Nt(Me,0,Me.mul(.3)),t=(l,u=1)=>Tt(M,s.add(e.mul(u)).mul(l).mod(1),0).r.add(.5);let h=t(.1);return h=h.mul(t(.05,1)),h=h.mul(t(.02,2)),L.mix(1,h)});const v=new te(new Xe(100,100,100),w);v.receiveShadow=!0,v.position.y=20,v.layers.disableAll(),v.layers.enable(m);const H=new se(16711680,5,4,10);H.layers.enable(m),H.position.set(0,-10,0),H.lookAt(0,0,0);const P=new se(65280,5,4,10);P.layers.enable(m),P.position.set(-10,0,0),P.lookAt(0,0,0);const _=new se(255,5,4,10);_.layers.enable(m),_.position.set(0,0,-10),_.lookAt(0,0,0);const I=s=>{const e=new st(4,10),t=new ot({color:s.color,side:at}),h=new nt({color:1118481}),l=new te(e,h);l.position.set(0,0,.08);const u=new te(e,t);u.position.set(0,0,.01),s.add(l),s.add(u)};I(H),I(P),I(_);const K=new At(y);$(()=>{K.renderer.setSize(o().width,o().height)});const De=Y(1),X=new Fe;X.disableAll(),X.enable(m),$(()=>{if(!n())return;const s=_e(C,n()),e=s.getTextureNode("depth");w.depthNode=e.sample(yt);const t=_e(C,n(),{depthBuffer:!1});t.setLayers(X),t.setResolutionScale(.25);const h=Y(.6),l=Dt(t,h),u=s.add(l.mul(De));K.outputNode=u});const q=200,D=new Ze(new Je(1),new ft({roughness:.05,color:"white"}),q);D.frustumCulled=!1;const Ge=new W().makeRotationX(.005).multiply(new W().makeRotationY(.005)).multiply(new W().makeRotationZ(.005)),F=new W;let E=0;const Z=s=>{const e=2*s+1;return e*e*e},Ce=(s,e)=>{const t=2*e+1;return s<t?{x:-e+s,y:e}:(s-=t,s<t-1?{x:e,y:e-1-s}:(s-=t-1,s<t-1?{x:e-1-s,y:-e}:(s-=t-1,{x:-e,y:-e+1+s})))},ie=(s,e)=>{let t=Math.ceil((Math.cbrt(s+1)-1)/2);for(t<0&&(t=0);Z(t)<=s;)t++;for(;t>0&&Z(t-1)>s;)t--;const h=t===0?0:Z(t-1);let l=s-h,u=0,p=0,N=0;if(t===0)u=0,p=0,N=0;else{const g=2*t+1,j=g*g;if(l<j)N=t,u=l%g-t,p=(l/g|0)-t;else{l-=j;const k=8*t,V=(g-2)*k;if(l<V){const U=l/k|0,je=l-U*k;N=t-1-U;const Pe=Ce(je,t);u=Pe.x,p=Pe.y}else l-=V,N=-t,u=l%g-t,p=(l/g|0)-t}}F.makeTranslation(u*e,p*e,N*e)},ze=new $e().setHSL(Math.random(),.8,1);for(;E<q;)ie(E,1),D.setMatrixAt(E,F),E+=1;let le=0,J=0,ce=0;Be(s=>{le+=s,f.current.applyMatrix4(Ge);for(let e=0;e<q;e+=1)ie(e,1+Math.sin(le)*.01*S.logSmooth01[32]/30),D.setMatrixAt(e,F);if(D.instanceMatrix.needsUpdate=!0,S.level>=.3){const e=Ue(ze,ce);D.setColorAt(J,e),J+=1,ce+=10,J%=q}D.instanceColor&&(D.instanceColor.needsUpdate=!0)}),Be(()=>{K.render()},{stage:c});var ue=Gt(),de=Qe(ue);O(de,()=>R.PerspectiveCamera,(s,e)=>{e(s,{makeDefault:!0,"position.y":1,"position.z":10,oncreate:t=>t.lookAt(0,0,0)})});var Ae=T(de,2);O(Ae,()=>R.AmbientLight,(s,e)=>{e(s,{intensity:.3})});var fe=T(Ae,2);O(fe,()=>R.DirectionalLight,(s,e)=>{e(s,{intensity:1,position:[0,3,0]})});var he=T(fe,2);O(he,()=>R.DirectionalLight,(s,e)=>{e(s,{intensity:.5,position:[0,3,2]})});var pe=T(he,2);O(pe,()=>R.DirectionalLight,(s,e)=>{e(s,{intensity:.25,position:[2,1,2]})});var me=T(pe,2);R(me,{get is(){return D}});var ve=T(me,2);R(ve,{get is(){return H}});var ge=T(ve,2);R(ge,{get is(){return P}});var we=T(ge,2);R(we,{get is(){return _}});var Le=T(we,2);R(Le,{get is(){return v}}),Ye(i,ue),qe(),A()}const Ut=Object.freeze(Object.defineProperty({__proto__:null,default:Ct},Symbol.toStringTag,{value:"Module"}));export{Ct as _,Ut as a};
