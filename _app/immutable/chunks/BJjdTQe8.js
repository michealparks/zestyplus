import"./DsnmJJEf.js";import{a3 as At,a8 as xt,ar as L,a6 as g,aa as It,a7 as h,f as t,a4 as l,b as V,a5 as gt,a9 as v}from"./B1dEFQYF.js";import{i as B}from"./C8lvtf9r.js";import{e as dt}from"./CKUK-ICo.js";import{c as $}from"./FGFIUSKv.js";import{p as C,a as Rt,r as Pt,b as Ht,s as rt}from"./BS1ha8Bm.js";import{ao as X,A as Bt,fZ as ft,f_ as r,es as Ct,ae as yt,af as $t,aq as Wt,x as qt,ai as Dt,B as zt,f$ as Ot,e1 as Ut}from"./52RvQVlY.js";import{u as at}from"./DsrGDIXs.js";import"./DWxn_hp4.js";import{s as jt}from"./Be9L29ol.js";import{e as Nt}from"./DCxBLCJT.js";import{R as Zt}from"./-ri7nH-n.js";function Lt(Y,a){At(a,!0);let p=C(a,"speed",3,1),A=C(a,"floatIntensity",3,1),x=C(a,"floatingRange",19,()=>[-.1,.1]),S=C(a,"rotationSpeed",3,0),u=C(a,"rotationIntensity",3,0),P=C(a,"seed",19,()=>1e4*Math.random()),T=C(a,"ref",15),j=Pt(a,["$$slots","$$events","$$legacy","speed","floatIntensity","floatingRange","rotationSpeed","rotationIntensity","seed","ref","children"]);const tt=new X,m=new X;let b=P();const N=Bt.mapLinear;let Z=l(()=>Array.isArray(p())?p():[p(),p(),p()]),E=l(()=>Array.isArray(A())?A():[A(),A(),A()]),H=l(()=>x().length===3?x():[[0,0],x(),[0,0]]),W=l(()=>Array.isArray(S())?S():[S(),S(),S()]),q=l(()=>Array.isArray(u())?u():[u(),u(),u()]);ft(w=>{b+=w,m.position.x=N(Math.sin(b/4*t(Z)[0])/10,-.1,.1,...t(H)[0])*t(E)[0],m.position.y=N(Math.sin(b/4*t(Z)[1])/10,-.1,.1,...t(H)[1])*t(E)[1],m.position.z=N(Math.sin(b/4*t(Z)[2])/10,-.1,.1,...t(H)[2])*t(E)[2],m.rotation.x=Math.cos(b/4*t(W)[0])/8*t(q)[0],m.rotation.y=Math.sin(b/4*t(W)[1])/8*t(q)[1],m.rotation.z=Math.sin(b/4*t(W)[2])/20*t(q)[2],m.updateMatrix()}),r(Y,Rt({get is(){return tt}},()=>j,{get ref(){return T()},set ref(w){T(w)},children:(w,F)=>{r(w,{get is(){return m},matrixAutoUpdate:!1,children:(D,J)=>{var G=L(),K=g(G);jt(K,()=>a.children??It,()=>({ref:m})),h(D,G)},$$slots:{default:!0}})},$$slots:{default:!0}})),xt()}class Et extends Ct{constructor(a,p){const A=[1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],x=new yt;x.setAttribute("position",new $t(A,3)),x.computeBoundingSphere();const S=new Wt({fog:!1});super(x,S),this.light=a,this.color=p,this.type="RectAreaLightHelper";const u=[1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],P=new yt;P.setAttribute("position",new $t(u,3)),P.computeBoundingSphere(),this.add(new qt(P,new Dt({side:zt,fog:!1})))}updateMatrixWorld(){if(this.scale.set(.5*this.light.width,.5*this.light.height,1),this.color!==void 0)this.material.color.set(this.color),this.children[0].material.color.set(this.color);else{this.material.color.copy(this.light.color).multiplyScalar(this.light.intensity);const a=this.material.color,p=Math.max(a.r,a.g,a.b);p>1&&a.multiplyScalar(1/p),this.children[0].material.color.copy(this.material.color)}this.matrixWorld.extractRotation(this.light.matrixWorld).scale(this.scale).copyPosition(this.light.matrixWorld),this.children[0].matrixWorld.copy(this.matrixWorld)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}}var Jt=gt("<!> <!> <!> <!> <!> <!> <!> <!> <!>",1),Kt=gt("<!> <!>",1),Qt=gt("<!> <!> <!> <!>",1);function Vt(Y,a){At(a,!0);const p=()=>rt(b,"$trainHeadGLTF",u),A=()=>rt(N,"$trainCarGLTF",u),x=()=>rt(Z,"$trackGLTF",u),S=()=>rt(E,"$tree1GLTF",u),[u,P]=Ht();Nt.setLTC(Zt.init());const{scene:T}=Ot();V(()=>(T.fog=new Ut("black"),T.fog.near=80,T.fog.far=200,()=>T.fog=null));const j=new X,tt=new X,m=new X,b=at("/glb/HighSpeed_Front.glb"),N=at("/glb/HighSpeed_Wagon.glb"),Z=at("/glb/RailwayTrack_Straight.glb"),E=at("/glb/Tree_1.glb"),H=l(()=>p()?.scene),W=l(()=>A()?.scene),q=l(()=>x()?.scene),w=l(()=>S()?.scene),F=l(()=>t(q)?Array.from({length:15}).map(()=>t(q).clone()):void 0),D=l(()=>t(W)?Array.from({length:4}).map(()=>t(W).clone()):void 0),J=l(()=>t(w)?Array.from({length:20}).map(()=>t(w).clone()):void 0);let G=0,K=-18;const et=e=>{e.castShadow=!0,e.receiveShadow=!0};V(()=>{t(H)?.traverse(et)}),V(()=>{if(t(D)){let e=11.5;for(const o of t(D))o.position.x=e,e+=11.5,o.traverse(et)}}),V(()=>{if(t(F)){let e=-18;for(const o of t(F))o.position.x=e,e+=18,o.traverse(et);G=t(F).length}}),V(()=>{if(t(J)){let e=-32,o=1;for(const c of t(J))o=-o,c.position.x=e,c.position.z=(Math.random()+.2)*100*o,c.scale.setScalar(Math.random()*.25+.75),c.rotation.y=Math.random()*2*Math.PI,e+=18,c.traverse(et)}});const St=10,bt=50;ft(e=>{j.position.x-=e*bt}),ft(()=>{if(!t(F))return;const{x:e}=j.position;e<K+St&&(G-=1,K-=18,t(F)[G].position.x=K,G===0&&(G=t(F).length))});var ht=Qt(),pt=g(ht);r(pt,{get is(){return j},children:(e,o)=>{var c=Jt(),y=g(c);{const n=(i,s)=>{let d=()=>s?.().ref;var _=L(),k=g(_);{var I=f=>{{let R=l(()=>[d()]);r(f,{get is(){return Et},get args(){return t(R)}})}};B(k,f=>{f(I)})}h(i,_)};$(y,()=>r.RectAreaLight,(i,s)=>{s(i,{width:6.8,height:.3,color:"#FFD700",intensity:20,position:[.75,1,1.02],oncreate:d=>{d.lookAt(.75,1,-2)},children:n,$$slots:{default:!0}})})}var M=v(y,2);$(M,()=>r.AmbientLight,(n,i)=>{i(n,{intensity:1})});var z=v(M,2);r(z,{get is(){return m},position:[0,1,0]});var Q=v(z,2);{const n=(i,s)=>{let d=()=>s?.().ref;var _=L(),k=g(_);{var I=f=>{var R=L(),ot=g(R);{let nt=l(()=>[d()]);$(ot,()=>r.DirectionalLightHelper,(it,st)=>{st(it,{get args(){return t(nt)},oncreate:lt=>{requestAnimationFrame(function ct(){requestAnimationFrame(ct),lt.update()})}})})}h(f,R)};B(k,f=>{f(I)})}h(i,_)};$(Q,()=>r.DirectionalLight,(i,s)=>{s(i,{intensity:1,castShadow:!0,position:[1,1,0],get target(){return m},children:n,$$slots:{default:!0}})})}var O=v(Q,2);r(O,{get is(){return tt},position:[-20,1,0]});var U=v(O,2);{const n=(i,s)=>{let d=()=>s?.().ref;var _=L(),k=g(_);{var I=f=>{var R=L(),ot=g(R);{let nt=l(()=>[d()]);$(ot,()=>r.SpotLightHelper,(it,st)=>{st(it,{get args(){return t(nt)},get attach(){return T},oncreate:lt=>{requestAnimationFrame(function ct(){requestAnimationFrame(ct),lt.update()})}})})}h(f,R)};B(k,f=>{f(I)})}h(i,_)};$(U,()=>r.SpotLight,(i,s)=>{s(i,{castShadow:!0,color:"#FFD700",penumbra:.9,position:[-5,1,0],intensity:20,angle:Math.PI/4,get target(){return tt},children:n,$$slots:{default:!0}})})}var _t=v(U,2);Lt(_t,{floatIntensity:3,speed:2,rotationIntensity:.3,rotationSpeed:2,children:(n,i)=>{var s=L(),d=g(s);$(d,()=>r.PerspectiveCamera,(_,k)=>{k(_,{makeDefault:!0,position:[-15,5,15],oncreate:I=>{I.lookAt(0,0,0)}})}),h(n,s)},$$slots:{default:!0}});var vt=v(_t,2);{var wt=n=>{r(n,{get is(){return t(H)}})};B(vt,n=>{t(H)&&n(wt)})}var Gt=v(vt,2);{var kt=n=>{var i=L(),s=g(i);dt(s,17,()=>t(D),d=>d.uuid,(d,_,k,I)=>{Lt(d,{floatIntensity:.01,speed:50,rotationIntensity:.001,rotationSpeed:20,children:(f,R)=>{r(f,{get is(){return t(_)}})},$$slots:{default:!0}})}),h(n,i)};B(Gt,n=>{t(D)&&n(kt)})}h(e,c)},$$slots:{default:!0}});var ut=v(pt,2);{var Ft=e=>{var o=L(),c=g(o);dt(c,17,()=>t(F),y=>y.uuid,(y,M,z,Q)=>{r(y,{get is(){return t(M)}})}),h(e,o)};B(ut,e=>{t(F)&&e(Ft)})}var mt=v(ut,2);{var Mt=e=>{var o=L(),c=g(o);dt(c,17,()=>t(J),y=>y.id,(y,M)=>{r(y,{get is(){return t(M)}})}),h(e,o)};B(mt,e=>{t(J)&&e(Mt)})}var Tt=v(mt,2);$(Tt,()=>r.Mesh,(e,o)=>{o(e,{position:[0,-.2,0],children:(c,y)=>{var M=Kt(),z=g(M);$(z,()=>r.BoxGeometry,(O,U)=>{U(O,{args:[1e4,.1,200]})});var Q=v(z,2);$(Q,()=>r.MeshToonMaterial,(O,U)=>{U(O,{color:"black"})}),h(c,M)},$$slots:{default:!0}})}),h(Y,ht),xt(),P()}const de=Object.freeze(Object.defineProperty({__proto__:null,default:Vt},Symbol.toStringTag,{value:"Module"}));export{Vt as _,de as a};
