import{a as D,t as X}from"./disclose-version.hHKxC-Jk.js";import{a0 as O,v as b,a1 as Q,a2 as I,n as H,a3 as f,w as J}from"./runtime.BZbTZrfI.js";import{c as k}from"./svelte-component.D2I4hVfC.js";import{aw as W,V,C as R,B as A,h as E,p as K,o as N,ax as $,I as tt,ay as et,J as ot,Q as at}from"./three.module.iKKkBh6O.js";import{u as Y,T as m,a as rt}from"./T.DXVn7S3O.js";import{u as nt}from"./analyser.svelte.98KYpyS5.js";import"./auth.svelte.C3nh3yTw.js";import{h as G}from"./color.D7bleQK4.js";import{f as st}from"./index.fMZ61YjE.js";import{R as it}from"./RoundedBoxGeometry.2rkyJQ98.js";import"./legacy.DAlpyf03.js";import{s as ct}from"./snippet.BOLubvD_.js";import{a as c,s as lt,r as dt}from"./props.DC6YhwhV.js";import{L as ut}from"./Lightformer.d7WdcZAn.js";const ft=`uniform float time;
attribute float size;
varying vec3 vColor;
void main() {
	vColor = color;
	vec4 mvPosition = modelViewMatrix * vec4(position, 0.5);
	gl_PointSize = size * (30.0 / -mvPosition.z) * (3.0 + sin(time + 100.0));
	gl_Position = projectionMatrix * mvPosition;
}`;var mt=X("<!> <!> <!>",1);function pt(L,a){O(a,!0);let r=c(a,"count",3,5e3),j=c(a,"radius",3,50),p=c(a,"depth",3,50),e=c(a,"factor",3,6),l=c(a,"saturation",3,1),g=c(a,"lightness",3,.8),h=c(a,"speed",3,1),d=c(a,"fade",3,!0),T=c(a,"opacity",3,1),S=c(a,"ref",15),P=dt(a,["$$slots","$$events","$$legacy","count","radius","depth","factor","saturation","lightness","speed","fade","opacity","ref","children"]);const z=new W,w=new V,_=new N,v=new R,F=s=>w.setFromSpherical(_.set(s,Math.acos(1-Math.random()*2),Math.random()*2*Math.PI));let y=new A(new Float32Array(r()*3),3),M=new A(new Float32Array(r()*3),3),x=new A(new Float32Array(r()),1);b(()=>{y=new A(new Float32Array(r()*3),3),M=new A(new Float32Array(r()*3),3),x=new A(new Float32Array(r()),1)}),b(()=>{const s=p()/r();let C=j()+p();for(let i=0;i<r();i+=1){C-=s*Math.random();const u=F(C);y.setXYZ(i,u.x,u.y,u.z),v.setHSL(i/r(),l(),g()),M.setXYZ(i,v.r,v.g,v.b),x.setX(i,(.5+.5*Math.random())*e())}});const{stop:B,start:U}=Y(s=>{t.time.value+=s*h()},{autoStart:!1});b(()=>h()===0?B():U());const t={time:{value:0},fade:{value:1},opacity:{value:1}},o=new E({uniforms:t,vertexShader:ft,fragmentShader:st});b(()=>{t.fade.value=d()?1:0}),b(()=>{t.opacity.value=T()});const n=new K;n.setAttribute("position",y),n.setAttribute("color",M),n.setAttribute("size",x),m(L,lt({is:z},()=>P,{get ref(){return S()},set ref(s){S(s)},children:(s,C)=>{var i=mt(),u=I(i);m(u,{is:n});var q=f(u,2);m(q,{is:o,blending:$,depthWrite:!1,transparent:!0,vertexColors:!0});var Z=f(q,2);ct(Z,()=>a.children??H,()=>({ref:z})),D(s,i)},$$slots:{default:!0}})),Q()}var ht=X("<!> <!>",1),vt=X("<!> <!> <!> <!> <!> <!>",1);function gt(L,a){O(a,!0);const{camera:r,scene:j}=rt(),p=1e3,e=new tt(void 0,void 0,p);e.name="cubes",e.frustumCulled=!1,e.castShadow=e.receiveShadow=!0;const l=new V,g=new at,h=new V(1,1,1),d=new ot,{frequencyData:T}=nt();let S=p-1;const P="#C84C09",z=new R(P);J(()=>{for(let t=0;t<p;t+=1){const o=(Math.random()-.5)*5,n=o>0?2:-2,s=(Math.random()-.5)*10;l.set(o*2+n,s,-t/2),g.random(),d.compose(l,g,h),e.setMatrixAt(t,d),e.setColorAt(t,G(z,0))}e.instanceColor&&(e.instanceColor.needsUpdate=!0),e.instanceMatrix.needsUpdate=!0});const w=new et;j.add(w.target);let _;Y(t=>{r.current.position.z-=t*20,_&&(_.position.z=r.current.position.z,w.position.z=r.current.position.z+2,w.target.position.copy(r.current.position));for(let o=0;o<p;o+=1){e.getMatrixAt(o,d),d.decompose(l,g,h);const n=T.current[o%32];h.setScalar(Math.max(n/100,.5)),e.setColorAt(o,G(z.set(P),n/1e3)),l.z>r.current.position.z&&(l.z=-S/2,S+=1),d.compose(l,g,h),e.setMatrixAt(o,d)}e.instanceColor&&(e.instanceColor.needsUpdate=!0),e.instanceMatrix.needsUpdate=!0});var v=vt(),F=I(v);k(F,()=>m.PerspectiveCamera,(t,o)=>{o(t,{makeDefault:!0,position:[0,.5,5],oncreate:n=>n.lookAt(0,0,.1)})});var y=f(F,2);m(y,{is:w,castShadow:!0,"position.x":2,"position.y":2,intensity:.5});var M=f(y,2);k(M,()=>m.AmbientLight,(t,o)=>{o(t,{intensity:.5})});var x=f(M,2);m(x,{is:e,children:(t,o)=>{var n=ht(),s=I(n);it(s,{});var C=f(s,2);k(C,()=>m.MeshStandardMaterial,(i,u)=>{u(i,{roughness:.05})}),D(t,n)},$$slots:{default:!0}});var B=f(x,2);ut(B,{});var U=f(B,2);pt(U,{get ref(){return _},set ref(t){_=t}}),D(L,v),Q()}const jt=Object.freeze(Object.defineProperty({__proto__:null,default:gt},Symbol.toStringTag,{value:"Module"}));export{gt as _,jt as a};
