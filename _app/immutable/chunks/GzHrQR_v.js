import"./DsnmJJEf.js";import{a3 as bt,a5 as xt,as as T,a8 as u,ab as Rt,a9 as p,i as t,a6 as c,d as W,ah as zt,a7 as gt,aa as l}from"./Wk8iZnnz.js";import{i as D}from"./CE2DFtFa.js";import{e as rt,i as Ht}from"./GTp4Qb7F.js";import{c as x}from"./BXm_g8N-.js";import{p as C,a as jt,r as Bt,b as Ot,s as at}from"./oafpEiTJ.js";import{aq as J,F as Ut,f_ as Z,f$ as n,fZ as qt,e1 as Et}from"./CtU81MLD.js";import{u as nt}from"./BFf-QOWf.js";import"./Bzur3xKn.js";import{s as Nt}from"./C5lbjxb5.js";import{f as Wt}from"./aEY0d7t_.js";import{R as Zt}from"./p4dozJBP.js";import{u as Jt}from"./CXVFCYzG.js";import Kt from"./BN6iQYxw.js";function Lt(ot,d){bt(d,!0);let w=C(d,"speed",3,1),A=C(d,"floatIntensity",3,1),j=C(d,"floatingRange",19,()=>[-.1,.1]),M=C(d,"rotationSpeed",3,0),h=C(d,"rotationIntensity",3,0),st=C(d,"seed",19,()=>1e4*Math.random()),K=C(d,"ref",15),P=Bt(d,["$$slots","$$events","$$legacy","speed","floatIntensity","floatingRange","rotationSpeed","rotationIntensity","seed","ref","children"]);const R=new J,f=new J;let _=st();const B=Ut.mapLinear;let O=c(()=>Array.isArray(w())?w():[w(),w(),w()]),U=c(()=>Array.isArray(A())?A():[A(),A(),A()]),q=c(()=>j().length===3?j():[[0,0],j(),[0,0]]),k=c(()=>Array.isArray(M())?M():[M(),M(),M()]),z=c(()=>Array.isArray(h())?h():[h(),h(),h()]);Z(F=>{_+=F,f.position.x=B(Math.sin(_/4*t(O)[0])/10,-.1,.1,...t(q)[0])*t(U)[0],f.position.y=B(Math.sin(_/4*t(O)[1])/10,-.1,.1,...t(q)[1])*t(U)[1],f.position.z=B(Math.sin(_/4*t(O)[2])/10,-.1,.1,...t(q)[2])*t(U)[2],f.rotation.x=Math.cos(_/4*t(k)[0])/8*t(z)[0],f.rotation.y=Math.sin(_/4*t(k)[1])/8*t(z)[1],f.rotation.z=Math.sin(_/4*t(k)[2])/20*t(z)[2],f.updateMatrix()}),n(ot,jt({get is(){return R}},()=>P,{get ref(){return K()},set ref(F){K(F)},children:(F,it)=>{n(F,{get is(){return f},matrixAutoUpdate:!1,children:(lt,Q)=>{var V=T(),$=u(V);Nt($,()=>d.children??Rt,()=>({ref:f})),p(lt,V)},$$slots:{default:!0}})},$$slots:{default:!0}})),xt()}var Qt=gt("<!> <!>",1),Vt=gt("<!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!>",1),Xt=gt("<!> <!> <!>",1);function Yt(ot,d){bt(d,!0);const w=()=>at(B,"$trainHeadGLTF",h),A=()=>at(O,"$trainCarGLTF",h),j=()=>at(U,"$trackGLTF",h),M=()=>at(q,"$tree1GLTF",h),[h,st]=Ot();Wt.setLTC(Zt.init());const K=Jt(),{scene:P}=qt();W(()=>(P.fog=new Et("black"),P.fog.near=100,P.fog.far=180,()=>P.fog=null));const R=new J,f=new J,_=new J,B=nt("/glb/HighSpeed_Front.glb"),O=nt("/glb/HighSpeed_Wagon.glb"),U=nt("/glb/RailwayTrack_Straight.glb"),q=nt("/glb/Tree_1.glb"),k=c(()=>w()?.scene),z=c(()=>A()?.scene),F=c(()=>j()?.scene),it=c(()=>M()?.scene),lt=15,Q=7,V=200,$=c(()=>t(F)?Array.from({length:lt}).map(()=>t(F).clone()):void 0),X=c(()=>t(z)?Array.from({length:Q}).map(()=>t(z).clone()):void 0),L=c(()=>t(it)?Array.from({length:V}).map(()=>t(it).clone()):void 0);let E=0,ct=-18,N=0,Y=-32;const tt=e=>{e.castShadow=!0,e.receiveShadow=!0},wt=1/3,mt=(e,r)=>{if(e.position.x=r,Math.random()<wt){const G=5+Math.random()*15;e.position.z=G}else{const G=20+Math.random()*70;e.position.z=-G}e.scale.setScalar(Math.random()*.25+.75),e.rotation.y=Math.random()*2*Math.PI};W(()=>{t(k)?.traverse(tt)}),W(()=>{if(t(X)){let e=11.5;for(const r of t(X))r.position.x=e,e+=11.5,r.traverse(tt)}}),W(()=>{if(t($)){let e=-18;for(const r of t($))r.position.x=e,e+=18,r.traverse(tt);E=t($).length}}),W(()=>{if(t(L)){let e=-32;for(const r of t(L))mt(r,e),e+=18,r.traverse(tt);N=t(L).length,Y=-32}});const ut=10,At=50;Z(e=>{R.position.x-=e*At}),Z(()=>{if(!t($))return;const{x:e}=R.position;e<ct+ut&&(E-=1,ct-=18,t($)[E].position.x=ct,E===0&&(E=t($).length))}),Z(()=>{if(!t(L))return;const{x:e}=R.position;if(e<Y+ut){N-=1,Y-=18;const r=t(L)[N];mt(r,Y),N===0&&(N=t(L).length)}});const dt=zt(Array.from({length:Q+1}).fill(0));Z(()=>{for(let e=0,r=0,v=dt.length;e<v;e+=1,r+=2)dt[e]=K.spectrum01[r]});var pt=Xt(),ht=u(pt);n(ht,{get is(){return R},children:(e,r)=>{var v=Vt(),g=u(v);x(g,()=>n.Mesh,(a,o)=>{o(a,{position:[0,-.2,0],children:(s,i)=>{var m=Qt(),y=u(m);x(y,()=>n.CylinderGeometry,(S,I)=>{I(S,{args:[900,900,.1]})});var H=l(y,2);x(H,()=>n.MeshStandardMaterial,(S,I)=>{I(S,{color:"#111",fog:!1})}),p(s,m)},$$slots:{default:!0}})});var b=l(g,2);Kt(b,{});var G=l(b,2);rt(G,17,()=>({length:Q+1}),Ht,(a,o,s)=>{var i=T(),m=u(i);{const y=(S,I)=>{var et=T(),Pt=u(et);D(Pt,te=>{}),p(S,et)};let H=c(()=>150*dt[s]);x(m,()=>n.RectAreaLight,(S,I)=>{I(S,{width:6.8,height:.3,color:"#FFD700",get intensity(){return t(H)},position:[.75+s*11.3,1,1.02],oncreate:et=>{et.lookAt(.75+s*11.3,1,-2)},children:y,$$slots:{default:!0}})})}p(a,i)});var ft=l(G,2);x(ft,()=>n.AmbientLight,(a,o)=>{o(a,{intensity:.2})});var $t=l(ft,2);n($t,{get is(){return _},position:[0,1,0]});var vt=l($t,2);{const a=(o,s)=>{var i=T(),m=u(i);D(m,y=>{}),p(o,i)};x(vt,()=>n.DirectionalLight,(o,s)=>{s(o,{intensity:1,castShadow:!0,color:"#FFF8DE",position:[-5,8,5],"shadow.camera.left":-50,"shadow.camera.right":50,"shadow.camera.top":50,"shadow.camera.bottom":-50,"shadow.mapSize.width":8192,"shadow.mapSize.height":8192,get target(){return _},children:a,$$slots:{default:!0}})})}var yt=l(vt,2);n(yt,{get is(){return f},position:[-20,1,0]});var St=l(yt,2);{const a=(o,s)=>{var i=T(),m=u(i);D(m,y=>{}),p(o,i)};x(St,()=>n.SpotLight,(o,s)=>{s(o,{castShadow:!0,color:"#FFD700",penumbra:.9,position:[-5,1,0],intensity:20,angle:Math.PI/4,get target(){return f},children:a,$$slots:{default:!0}})})}var Tt=l(St,2);Lt(Tt,{floatIntensity:3,speed:2,rotationIntensity:.3,rotationSpeed:2,children:(a,o)=>{var s=T(),i=u(s);x(i,()=>n.PerspectiveCamera,(m,y)=>{y(m,{makeDefault:!0,position:[-15,5,15],oncreate:H=>{H.lookAt(0,0,0)}})}),p(a,s)},$$slots:{default:!0}});var Ft=l(Tt,2);{var It=a=>{n(a,{get is(){return t(k)}})};D(Ft,a=>{t(k)&&a(It)})}var Dt=l(Ft,2);{var Ct=a=>{var o=T(),s=u(o);rt(s,17,()=>t(X),i=>i.uuid,(i,m,y,H)=>{Lt(i,{floatIntensity:.01,speed:50,rotationIntensity:.001,rotationSpeed:20,children:(S,I)=>{n(S,{get is(){return t(m)}})},$$slots:{default:!0}})}),p(a,o)};D(Dt,a=>{t(X)&&a(Ct)})}p(e,v)},$$slots:{default:!0}});var _t=l(ht,2);{var Mt=e=>{var r=T(),v=u(r);rt(v,17,()=>t($),g=>g.uuid,(g,b,G,ft)=>{n(g,{get is(){return t(b)}})}),p(e,r)};D(_t,e=>{t($)&&e(Mt)})}var kt=l(_t,2);{var Gt=e=>{var r=T(),v=u(r);rt(v,17,()=>t(L),g=>g.id,(g,b)=>{n(g,{get is(){return t(b)}})}),p(e,r)};D(kt,e=>{t(L)&&e(Gt)})}p(ot,pt),xt(),st()}const pe=Object.freeze(Object.defineProperty({__proto__:null,default:Yt},Symbol.toStringTag,{value:"Module"}));export{Yt as _,pe as a};
