import{V as s,B as I}from"./T.6-q_PtqM.js";function D(A,M=Math.PI/3){const $=Math.cos(M),p=(1+1e-10)*100,r=[new s,new s,new s],l=new s,b=new s,d=new s,n=new s;function z(t){const u=~~(t.x*p),o=~~(t.y*p),a=~~(t.z*p);return`${u},${o},${a}`}const V=A.index?A.toNonIndexed():A,e=V.attributes.position,h={};for(let t=0,u=e.count/3;t<u;t++){const o=3*t,a=r[0].fromBufferAttribute(e,o+0),i=r[1].fromBufferAttribute(e,o+1),w=r[2].fromBufferAttribute(e,o+2);l.subVectors(w,i),b.subVectors(a,i);const c=new s().crossVectors(l,b).normalize();for(let m=0;m<3;m++){const x=r[m],f=z(x);f in h||(h[f]=[]),h[f].push(c)}}const k=new Float32Array(e.count*3),N=new I(k,3,!1);for(let t=0,u=e.count/3;t<u;t++){const o=3*t,a=r[0].fromBufferAttribute(e,o+0),i=r[1].fromBufferAttribute(e,o+1),w=r[2].fromBufferAttribute(e,o+2);l.subVectors(w,i),b.subVectors(a,i),d.crossVectors(l,b).normalize();for(let c=0;c<3;c++){const m=r[c],x=z(m),f=h[x];n.set(0,0,0);for(let B=0,v=f.length;B<v;B++){const y=f[B];d.dot(y)>$&&n.add(y)}n.normalize(),N.setXYZ(o+c,n.x,n.y,n.z)}}return V.setAttribute("normal",N),V}export{D as t};
